###############
# Discussions #
###############

Limitations de IG des 10k candle/mois en fetch :
    - selon la stratégie on en a besoin au moins de 47 à chaque démarrage pour se synchroniser,
        - cela permet 21 démarrages par mois avec 10 symboles, ce qui est large même si on relance 1x ou 2 par semaine.
    - besoin de synchro depuis les imports MT5 ou d'une autre source CFD
        - ou mieux depuis une source data avec des volumes futures pour indices, metals, forex

Distance et timeout-distance si en DIST doivent être supporté par distance_type et timeout_distance_type dans les methode de SL/TP et dynamiques.

Bootstrap et Preprocess risque de se recouvrer dans certains cas :
    - comment eviter cela si la stratégie execute les 2 méthodes ?
    - le bootstrap devrait être retiré au profit d'une initialisation des signaux
        - utilisant le depth normal, pas d'history comme ça
            - on a bourricot, firebird et scalpspectre qui bootstrap
                - bourricot : c'est juste pour détecter les pullback, ça peu se faire sans état
                - scalpspectre : pas besoin car c'est pour du scalp et est abandonné
                - firebird : pareil que pour bourricot on peu calculer les flags autrement
            => une méthode bootstrap mais qui ne rejout pas les candles :
                - ce qui en plus évite les imprecisions de ce pseudo replay


############
# EN COURS #
############

#116 kraken watcher et trader :
    - fetch des positions (mais on l'a avec le WS)
    - fetch des trades history (mais on l'a avec le WS)
    - WS des trades/positions
        - comment savoir si trade maker ou taker ?
        - revoir que si besoin ownTrade pour signal TRADED
    - 'cumulative-commission-amount' pour les fees, seulement géré sur assettrade, mais devrait être supporté par les autres
    - si on gere a sell les fee sur quote et qu'il manque en fiat... ça va rejeter, et si on laisse par defaut sur asset alors il faut 
        bien que les calcules interne et arrondis soient bien calculés

#112 Dans local reste 27 strategies a convertir vers le nouveau format (probablement certaines a supprimer)

#113 Dans siis-lab reste 18 strategies a convertir vers le nouveau format (probablement certaines a supprimer)

#24 Uniformiser l'order book (bitmex, binance, binancefutures, kraken)
    - avoir un object OrderBook facile à mettre à jour et à exploiter
    - utiliser DepthCacheManager pour binance et binancefutures

#100 active regions view

#102 trade_quantity in percent of account, ou plutôt en % de risque sur le compte

#103 WebTrader
    - gérer play/pause par market
    - charting OHLC et ticks (streaming) + performance
    - goto charting historique sur un trade passé
    - récupération des trades historiques à la connexion (ou reformater le format de rapport avec les dumps, donc revoir la table cli)
    - details trade avec modal
    - helper pour le DSL
    - session expiry message to renew
    - active alerts prefetch à la connexion, WS d'update et de delete (à chaque trigger countdown peu changer)
    - ticker WS, basé sur quoi ? trader ticker ? strategy instrument ?
        - plutôt sur le trader car pas besoin de surcharger encore le strategy trader
    - streamer et afficher balance, margin du compte
    - copy de signal
    - toggle audio and save in cookie

#104 decouper les commande de strategy par fichier dans command/

#108 Move from siis.py for the resting command part to command_handler

#89 Finir les conversion des tools avec le model Tool (binarizer, fetcher, optimizer)


#######
# BUG #
#######

#114 Supprimer le client chart une fois la version web réalisée, donc ce bug ne devrait plus être

#87 Problème sur le comptage de la quantité de sortie, et du prix moyen de sortie d'un trade
    - En effet si la sortie est effectué par plusieurs ordres dans le cas du filled et exec-price, pas de problème,
        tout s'ajoute, mais si on a que cumulative-filled et avg-price alors remplacer les valeurs comme sur
        le trade d'entré va écraser les valeurs liées au trades de sorties précédents.
        - Exemple un take-profit limit, mais mettons la quantité n'est pas fully-filled, et finalement intervient
            pour une raison (stop-loss, timeout) un ordre de sortie au market (qui va devoir cancel le premier orde)
    - Donc gérer peut être 2 compteurs pour la sortie, un temporaire lié au trade de sortie actif, et le normal

#95 Parfois on a un problème de quantité d'asset sur le paper-trader.

#96 Valeur d'un pip pour les marchés BitMex => et corriger ainsi calcule uPnl.
    - Enfin même question avec BinanceFutures, calcule fait sur une supposition, mais par contre reste le prob pour le uPnl

#75 TD9 countdown a debug et tester


##########
# URGENT #
##########

#117 Normalize les dumps de trades history (voir de active) pour la partie stats par trader et pour le fetch history

#57 Vérification des trades au rechargement :
    - Cas des positions indépendante (CFD, future) : pas de soucis tant qu'on retrouve la position et les ordres
    - Cas des crypto margin: si on rate un trade event, on va perdre le compte : reprendre l'historique des trades, ça devient l'usine à gérer
    - Cas des crypto spot : pareil si on rate un trade event...
    => On pourrait depuis le watcher récupérer à la connexion tout les TRADES
        - On le fait déjà en fait sur binance pour les asset non vide (nouvellement non vide (valeur fetched) ou précédemment non vide (valeur stocké en DB))
            - pour binance.com c'est un peu lent et ça consomme du crédit
            - pour bitmex.com on a get_historical_trades(...)
            - pour ig.com pas de question à se poser on regarde l'état de la position, et éventuellement les ordres actifs qu'on a fetched

#63 Mode backup urgency :
    - Instance démarré à coté pour fermer les trades en profit et se fermer une fois tous les trades fermé


#############
# REFLEXION #
#############

#111 Connecteur rapidapi-yahoo-finance pour récupérer stock, indices, forex quotes, et pouvoir le mapper à un autre broker example (ig.com)


#######
# TOP #
#######

#60 Gérer la partie locked sur le paper trader en mode asset
    - C'est à dire ne pas tout gérer en free, ce n'est pas super important au final car ça n'empêche pas le fonctionnement,
        mais c'est pour être plus rigoureux.

#110 Ajouter un fetcher rapidapi-morningstar pour récupérer les actions et indices intraday, D, W, M.
    - Faire un mapping pour que cela puisse être utilisé depuis le watcher IG pour le prefetching


########
# LESS #
########

#85 Ajouter TradeOp : TriggerEntry et TriggerLimitEntry, l'intérêt c'est d'avoir le trigger coté bot, pour ne pas bloquer les fonds coté broker

#98 Fetcher, Watcher PyEX (mais c'est payant) => rapidapi-morningstar mais pas de WS

#115 Fetcher, Watche polygon.io (99$ à 399$ / mois) => selon 1m ou tick, REST ou WS


#########
# OPTIM #
#########

#


#########################
## Idées de stratégies ##
#########################

- TD9 : 9 13 9, double setup, aggressive, combiné avec RSI par exemple et MA pour les double setup
- Mode HHT (Hilbert) et min/max par modes
- Détection de breakout sur bollinger (renforce un signal, un trade, ou stop un trade inverse)
- SL sur TD9, sous/sur bollinger, sous/sur last min/max, sous/sur fibo
- Détection de canaux, triangles
- Détection des patterns elliotists
- Détection des harmonic patterns
- Bollinger + triangle => pullback + count number of pullback => break
- Chande Kroll Stop @ref https://www.centralcharts.com/fr/forums/12-analyse-technique/1366-indicateur-chande-kroll-stop
- Algo-G pour optimiser les paramètres
- ML avec TensorFlow selon différent indicateurs ou encore selon des signaux prétraité (hilbert...)

- Le signal doit être annulé si le prix dépasse (long) celui de la réintégration de la BB (inverse pour short)
- prix de TP :
    1) on a une MA20 50 100 ou 200 dans la bollinger, on prend la plus éloignée qui est dans la BB
    2) si pas assez loin ou en dehors, on cherche la tenkan (si assez loin du prix)
    3) on prend le précédent ATR le plus loin dans la BB ou le en cours si rien d'autre
    4) fixed-pct ou fixed-distance si rien d'autre
- prix de SL :
    1) current ATR si == bas de la bougie de break
    2) precedent ATR en dessous de la open de la bougie de réintégration
    3) fixed
- entrée :
    1) vérifier qu'on est tjs dans la partie basse (inversement haute) de la bollinger (fait mais semble pas suffire)
    2) vérifier le % min, limité par la bollinger opposés, qu'il soit suffisant
    3) le corps de la bougie de confirmation doit être au moins N x epsilon
    4) valider une entré sur une HMA20 dépassée par la close de conf
    5) Ajouter une RSI a bourricot, et si div de RSI3 en 1m alors oui signal sinon continuation
- sortie :
    1) TP initial, on l'écarte tant que les bougies sont rouges
    2) Si verte que à partir du price epsilon sinon on la compte comme rouge
    3) On coupe si signal opposé sur la même timeframe
